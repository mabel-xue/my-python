# -*- coding: utf-8 -*-

from bs4 import BeautifulSoup
import pandas as pd

html = '<div class="tab-pane al-description fade active show" id="alkey-yearly" role="tabpanel" aria-labelledby="alkey-alyearly-tab"><table class="table table-hover table-scroll"><thead><tr><th class="p-1">类别</th><th class="p-1">财务比率</th><th class="p-1">趋势</th><th class="p-1">2019</th><th class="p-1">2020</th><th class="p-1">2021</th><th class="p-1">2022</th><th class="p-1">近12个月</th></tr></thead><tbody><tr><th class="p-1" rowspan="2"><span data-toggle="tooltip" data-placement="top" title="经营杠杆,看公司是否有破产危机">财务结构</span></th><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/debt_ratio">负债占资产比率(%)</a></span></td><td class="p-1 trend"><span class="line">13.9,36.9,54.8,57.4,57.4</span></td><td class="p-1">13.9</td><td class="p-1">36.9</td><td class="p-1">54.8</td><td class="p-1">57.4</td><td class="p-1">57.4</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/longterm_ratio">长期资金占重资产比率(%)</a></span></td><td class="p-1 trend"><span class="line">128.1,136.7,161.3,159.3,160.9</span></td><td class="p-1">128.1</td><td class="p-1">136.7</td><td class="p-1">161.3</td><td class="p-1">159.3</td><td class="p-1">160.9</td></tr><tr class="tr-split-border"><th class="p-1" rowspan="3"><span data-toggle="tooltip" data-placement="top" title="危机情况下的企业清偿能力">偿债能力</span></th><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/current_ratio">流动比率(%)</a></span></td><td class="p-1 trend"><span class="line">170.2,68.8,110.9,62.8,72.4</span></td><td class="p-1">170.2</td><td class="p-1">68.8</td><td class="p-1">110.9</td><td class="p-1">62.8</td><td class="p-1">72.4</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/quick_ratio">速动比率(%)</a></span></td><td class="p-1 trend"><span class="line">169.9,68.5,110.7,62.7,72.1</span></td><td class="p-1">169.9</td><td class="p-1">68.5</td><td class="p-1">110.7</td><td class="p-1">62.7</td><td class="p-1">72.1</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/interest_coverage">利息保障倍数</a></span></td><td class="p-1 trend"><span class="line">725751594.3,18691046.7,0.8,-2.9,-2.2</span></td><td class="p-1">∞</td><td class="p-1">∞</td><td class="p-1">0.8</td><td class="p-1">-2.9</td><td class="p-1">-2.2</td></tr><tr class="tr-split-border"><th class="p-1" rowspan="9"><span data-toggle="tooltip" data-placement="top"title="企业自身的运营水平,通常取决于管理水平">运营能力</span></th><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/receivable_turnover_ratio">应收款项周转率(次/年)</a></span></td><td class="p-1 trend"><span class="line">8.4,6.1,6.6,5.3,4.7</span></td><td class="p-1">8.4</td><td class="p-1">6.1</td><td class="p-1">6.6</td><td class="p-1">5.3</td><td class="p-1">4.7</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/receivable_turnover_date">应收款项周转天数(天)</a></span></td><td class="p-1 trend"><span class="line">43.3,59.5,55.3,68.7,78.0</span></td><td class="p-1">43.3</td><td class="p-1">59.5</td><td class="p-1">55.3</td><td class="p-1">68.7</td><td class="p-1">78.0</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/inventories_turnover_ratio">存货周转率(次/年)</a></span></td><td class="p-1 trend"><span class="line">489.9,378.5,375.6,544.3,437.1</span></td><td class="p-1">489.9</td><td class="p-1">378.5</td><td class="p-1">375.6</td><td class="p-1">544.3</td><td class="p-1">437.1</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/inventories_turnover_date">存货周转天数(天)</a></span></td><td class="p-1 trend"><span class="line">0.7,1.0,1.0,0.7,0.8</span></td><td class="p-1">0.7</td><td class="p-1">1.0</td><td class="p-1">1.0</td><td class="p-1">0.7</td><td class="p-1">0.8</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/fixed_assets_turnover_ratio">固定资产周转率(次/年)</a></span></td><td class="p-1 trend"><span class="line">0.5,0.4,0.3,0.2,0.2</span></td><td class="p-1">0.5</td><td class="p-1">0.4</td><td class="p-1">0.3</td><td class="p-1">0.2</td><td class="p-1">0.2</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/total_turnover_date">完整生意周期(天)</a></span></td><td class="p-1 trend"><span class="line">44.1,60.4,56.2,69.4,78.8</span></td><td class="p-1">44.1</td><td class="p-1">60.4</td><td class="p-1">56.2</td><td class="p-1">69.4</td><td class="p-1">78.8</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/ap_turnover_date">应付款项周转天数(天)</a></span></td><td class="p-1 trend"><span class="line">2.3,2.4,1.8,1.1,1.2</span></td><td class="p-1">2.3</td><td class="p-1">2.4</td><td class="p-1">1.8</td><td class="p-1">1.1</td><td class="p-1">1.2</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/money_needed_date">缺钱天数(天)</a></span></td><td class="p-1 trend"><span class="line">41.8,58.0,54.4,68.3,77.7</span></td><td class="p-1">41.8</td><td class="p-1">58.0</td><td class="p-1">54.4</td><td class="p-1">68.3</td><td class="p-1">77.7</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/t_assets_turnover_ratio">总资产周转率(次/年)</a></span></td><td class="p-1 trend"><span class="line">0.28,0.18,0.16,0.1,0.11</span></td><td class="p-1">0.28</td><td class="p-1">0.18</td><td class="p-1">0.16</td><td class="p-1">0.10</td><td class="p-1">0.11</td></tr><tr class="tr-split-border"><th class="p-1" rowspan="10"><span data-toggle="tooltip" data-placement="top"title="行业,产品与服务的利润水平,取决于同行竞争力度">盈利能力</span></th><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/roa">ROA=资产收益率(%)</a></span></td><td class="p-1 trend"><span class="line">4.4,0.2,-0.1,-4.4,-3.7</span></td><td class="p-1">4.4</td><td class="p-1">0.2</td><td class="p-1">-0.1</td><td class="p-1">-4.4</td><td class="p-1">-3.7</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/roe">ROE=净资产收益率(%)</a></span></td><td class="p-1 trend"><span class="line">5.0,0.2,-0.3,-10.1,-8.6</span></td><td class="p-1">5.0</td><td class="p-1">0.2</td><td class="p-1">-0.3</td><td class="p-1">-10.1</td><td class="p-1">-8.6</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/roic">ROIC=资本回报率(%)</a></span></td><td class="p-1 trend"><span class="line">4.8,0.1,0.8,0.0,0.0</span></td><td class="p-1">4.8</td><td class="p-1">0.1</td><td class="p-1">0.8</td><td class="p-1">0.0</td><td class="p-1">0.0</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/pre_tax_net_income_ratio">税前纯益占实收资本(%)</a></span></td><td class="p-1 trend"><span class="line">37.9,2.6,-1.3,-70.0,-57.4</span></td><td class="p-1">37.9</td><td class="p-1">2.6</td><td class="p-1">-1.3</td><td class="p-1">-70.0</td><td class="p-1">-57.4</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/gross_margin_ratio">毛利率(%)</a></span></td><td class="p-1 trend"><span class="line">23.7,6.4,8.3,-35.2,-22.8</span></td><td class="p-1">23.7</td><td class="p-1">6.4</td><td class="p-1">8.3</td><td class="p-1">-35.2</td><td class="p-1">-22.8</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/operating_profit_ratio">营业利润率(%)</a></span></td><td class="p-1 trend"><span class="line">22.5,2.0,-0.3,-53.0,-39.5</span></td><td class="p-1">22.5</td><td class="p-1">2.0</td><td class="p-1">-0.3</td><td class="p-1">-53.0</td><td class="p-1">-39.5</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/net_profit_ratio">净利率(%)</a></span></td><td class="p-1 trend"><span class="line">15.9,1.3,-0.6,-42.2,-32.0</span></td><td class="p-1">15.9</td><td class="p-1">1.3</td><td class="p-1">-0.6</td><td class="p-1">-42.2</td><td class="p-1">-32.0</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/scale_charges_ratio">营业费用率(%)</a></span></td><td class="p-1 trend"><span class="line">1.7,3.7,8.4,19.1,17.6</span></td><td class="p-1">1.7</td><td class="p-1">3.7</td><td class="p-1">8.4</td><td class="p-1">19.1</td><td class="p-1">17.6</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/safety_ratio">经营安全边际率(%)</a></span></td><td class="p-1 trend"><span class="line">94.7,30.8,-4.1,0.0,0.0</span></td><td class="p-1">94.7</td><td class="p-1">30.8</td><td class="p-1">-4.1</td><td class="p-1">0.0</td><td class="p-1">0.0</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/eps">EPS=基本每股收益(元)</a></span></td><td class="p-1 trend"><span class="line">0.29,0.01,-0.02,-0.56,-0.46</span></td><td class="p-1">0.29</td><td class="p-1">0.01</td><td class="p-1">-0.02</td><td class="p-1">-0.56</td><td class="p-1">-0.46</td></tr><tr class="tr-split-border"><th class="p-1" rowspan="3"><span data-toggle="tooltip" data-placement="top" title="企业的成长速度">成长能力</span></th><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/operating_revenue_growth">营收增长率(%)</a></span></td><td class="p-1 trend"><span class="line">5.8,-21.3,10.3,-19.2,40.0</span></td><td class="p-1">5.8</td><td class="p-1">-21.3</td><td class="p-1">10.3</td><td class="p-1">-19.2</td><td class="p-1">40.0</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/operating_profit_growth">营业利润增长率(%)</a></span></td><td class="p-1 trend"><span class="line">-2.7,-93.1,-119.3,100.0,100.0</span></td><td class="p-1">-2.7</td><td class="p-1">-93.1</td><td class="p-1">-119.3</td><td class="p-1">100.0</td><td class="p-1">100.0</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/net_assets_growth">净资本增长率(%)</a></span></td><td class="p-1 trend"><span class="line">3.6,-1.2,-0.3,-10.1,-8.7</span></td><td class="p-1">3.6</td><td class="p-1">-1.2</td><td class="p-1">-0.3</td><td class="p-1">-10.1</td><td class="p-1">-8.7</td></tr><tr class="tr-split-border"><th class="p-1" rowspan="3"><span data-toggle="tooltip" data-placement="top"title="企业的现金流状况,取决于公司的自身财务管理水平">现金流量</span></th><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/cashflow_ratio">现金流量比率(%)</a></span></td><td class="p-1 trend"><span class="line">51.5,15.8,26.4,8.0,7.0</span></td><td class="p-1">51.5</td><td class="p-1">15.8</td><td class="p-1">26.4</td><td class="p-1">8.0</td><td class="p-1">7.0</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/cashflow_adequacy_ratio">现金流量允当比率(%)</a></span></td><td class="p-1 trend"><span class="line">133.7,69.3,48.8,35.0,34.5</span></td><td class="p-1">133.7</td><td class="p-1">69.3</td><td class="p-1">48.8</td><td class="p-1">35.0</td><td class="p-1">34.5</td></tr><tr><td class="p-1"><span><a class="wiki-terms" href="/terms/000089/cash_reinvestment_ratio">现金再投资比率(%)</a></span></td><td class="p-1 trend"><span class="line">-5.2,-3.7,3.1,-0.6,-2.3</span></td><td class="p-1">-5.2</td><td class="p-1">-3.7</td><td class="p-1">3.1</td><td class="p-1">-0.6</td><td class="p-1">-2.3</td></tr></tbody></table></div>'

soup = BeautifulSoup(html, 'html.parser')
div = soup.find('div', {'id': 'alkey-yearly'})
table = div.find('table')
df = pd.read_html(str(table), encoding='utf-8')[0]
# print(df)
writer = pd.ExcelWriter('output1.xlsx', engine='openpyxl')

df.to_excel(writer, index=False)
writer.save()